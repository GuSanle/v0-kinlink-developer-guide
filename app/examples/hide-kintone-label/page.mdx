import { Tabs, TabsContent, TabsList, TabsTrigger } from "@/components/ui/tabs";
import { CodeBlock } from "@/components/code-block";
import Link from "next/link";
import { ArrowLeft } from "lucide-react";
import { Button } from "@/components/ui/button";

<div className="container max-w-4xl py-6 lg:py-10 mdx-content">
  <div className="flex items-center gap-4 mb-8">
    <Link href="/examples" className="flex items-center">
      <Button variant="outline" size="icon" className="h-10 w-10 flex items-center justify-center">
        <ArrowLeft className="h-4 w-4" />
      </Button>
    </Link>
    <h1 className="text-3xl font-bold tracking-tight m-0 p-0 leading-[1.2] flex items-center">éšè—kintoneæ ‡ç­¾ç¤ºä¾‹</h1>
  </div>

  <div className="space-y-8 px-8">
    <div>
      <h2>æ ‡ç­¾éšè—ç®¡ç†æ¦‚è§ˆ</h2>
      
      > ç²¾ç¡®æ§åˆ¶è¡¨å•å­—æ®µæ ‡ç­¾æ˜¾ç¤ºï¼Œåˆ›é€ ç®€æ´æµç•…çš„ç”¨æˆ·ç•Œé¢

      æ­¤ç¤ºä¾‹æ¼”ç¤ºå¦‚ä½•ä½¿ç”¨**kinlink API**éšè—è¡¨å•å­—æ®µçš„**åŸç”Ÿæ ‡ç­¾**ï¼Œå®ç°**æç®€è¡¨å•è®¾è®¡**å’Œ**è‡ªå®šä¹‰æ ‡ç­¾å¸ƒå±€**ã€‚é€šè¿‡éšè—ç³»ç»Ÿæ ‡ç­¾ï¼Œå¯ä»¥åˆ›å»ºæ›´å…·è®¾è®¡æ„Ÿçš„è¡¨å•ç•Œé¢ï¼ŒåŒæ—¶ä¿æŒå­—æ®µåŠŸèƒ½å®Œæ•´ã€‚

      ### æ ‡ç­¾éšè—æ ¸å¿ƒåŠŸèƒ½
      - ğŸ¯ **ç²¾å‡†éšè—**ï¼šé€‰æ‹©æ€§éšè—ç‰¹å®šå­—æ®µæ ‡ç­¾
      - ğŸ¨ **ç•Œé¢ç®€åŒ–**ï¼šåˆ›é€ æ›´ç®€æ´çš„è§†è§‰æ•ˆæœ
      - ğŸ“± **ç§»åŠ¨ä¼˜åŒ–**ï¼šåœ¨å°å±å¹•ä¸Šä¼˜åŒ–ç©ºé—´ä½¿ç”¨
      - ğŸ”§ **è‡ªå®šä¹‰å¸ƒå±€**ï¼šä¸ºè‡ªå®šä¹‰æ ‡ç­¾è…¾å‡ºç©ºé—´
      - âš¡ **æ€§èƒ½å‹å¥½**ï¼šä¸å½±å“è¡¨å•åŠ è½½å’Œæäº¤æ€§èƒ½
      - ğŸ”„ **åŠ¨æ€æ§åˆ¶**ï¼šå¯æ ¹æ®æ¡ä»¶åŠ¨æ€æ˜¾ç¤ºæˆ–éšè—æ ‡ç­¾
    </div>

    <div>
      <h2>å…³é”®åŠŸèƒ½</h2>
      <ul>
        <li>æ‰¹é‡éšè—å¤šä¸ªå­—æ®µæ ‡ç­¾</li>
        <li>ä¿æŒå­—æ®µåŠŸèƒ½å®Œæ•´æ€§</li>
        <li>ä¼˜åŒ–ç§»åŠ¨ç«¯æ˜¾ç¤ºæ•ˆæœ</li>
        <li>æ”¯æŒåŠ¨æ€æ ‡ç­¾åˆ‡æ¢</li>
      </ul>
    </div>

    <div>
      <h2>ä»£ç ç¤ºä¾‹</h2>
      <div className="-ml-8">
        <Tabs defaultValue="javascript">
          <TabsList className="ml-8">
            <TabsTrigger value="javascript">JavaScript</TabsTrigger>
          </TabsList>
          <TabsContent value="javascript" className="mt-4">
            <CodeBlock 
              code={`/**
 * ç¤ºä¾‹12: éšè—kintoneæ ‡ç­¾
 * åŠŸèƒ½ï¼šéšè—æŒ‡å®šå­—æ®µçš„åŸç”Ÿæ ‡ç­¾ï¼Œåˆ›é€ ç®€æ´ç•Œé¢
 */
(function () {
  kinlink.events.on(kinlink.FormEvents.FORM_LOADED, () => {
    try {
      // å®šä¹‰éœ€è¦éšè—æ ‡ç­¾çš„å­—æ®µåˆ—è¡¨
      const fieldsToHideLabels = [
        'æ–‡å­—åˆ—__1è¡Œ__0',  // å§“åå­—æ®µ
        'æ–‡å­—åˆ—__1è¡Œ__1',  // å‡åå­—æ®µ
        'æ–‡å­—åˆ—__1è¡Œ__2',  // ç”µè¯å­—æ®µ
        'æ–‡å­—åˆ—__1è¡Œ__3',  // é‚®ç®±å­—æ®µ
        'å•è¡Œæ–‡æœ¬æ¡†_10',   // å…¬å¸å­—æ®µ
        'å•è¡Œæ–‡æœ¬æ¡†_11'    // èº«ä»½è¯å­—æ®µ
      ];

      console.log('å¼€å§‹éšè—å­—æ®µæ ‡ç­¾...');

      // æ‰¹é‡éšè—æ ‡ç­¾
      hideMultipleLabels(fieldsToHideLabels);

      // åˆ›å»ºæ ‡ç­¾æ§åˆ¶é¢æ¿
      const controlPanel = createLabelControlPanel(fieldsToHideLabels);
      
      // å°†æ§åˆ¶é¢æ¿æ·»åŠ åˆ°è¡¨å•é¡¶éƒ¨
      const formElement = document.querySelector('.ant-form') || document.body;
      formElement.insertBefore(controlPanel, formElement.firstChild);

      // ä¸ºå­—æ®µæ·»åŠ å ä½ç¬¦ï¼Œè¡¥å¿éšè—çš„æ ‡ç­¾
      addPlaceholdersForHiddenLabels(fieldsToHideLabels);

      // ç§»åŠ¨ç«¯ä¼˜åŒ–å¤„ç†
      setupMobileOptimization();

      console.log('æ ‡ç­¾éšè—è®¾ç½®å®Œæˆ');

    } catch (error) {
      console.error('éšè—kintoneæ ‡ç­¾å¤±è´¥:', error);
    }
  });

  // æ‰¹é‡éšè—æ ‡ç­¾
  function hideMultipleLabels(fieldCodes) {
    fieldCodes.forEach((fieldCode, index) => {
      try {
        kinlink.formApi.hideFieldLabel(fieldCode);
        console.log(\`å·²éšè—å­—æ®µ \${fieldCode} çš„æ ‡ç­¾\`);
        
        // æ·»åŠ æ¸è¿›å¼éšè—æ•ˆæœ
        setTimeout(() => {
          const element = kinlink.formApi.getFieldElement(fieldCode);
          if (element) {
            addHiddenLabelEffect(element);
          }
        }, index * 100); // å»¶è¿Ÿæ‰§è¡Œï¼Œåˆ›é€ æ¸è¿›æ•ˆæœ
        
      } catch (error) {
        console.warn(\`éšè—å­—æ®µ \${fieldCode} æ ‡ç­¾å¤±è´¥:\`, error);
      }
    });
  }

  // åˆ›å»ºæ ‡ç­¾æ§åˆ¶é¢æ¿
  function createLabelControlPanel(fieldCodes) {
    const panel = document.createElement('div');
    panel.className = 'label-control-panel';
    panel.style.cssText = \`
      margin: 15px 0;
      padding: 20px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border-radius: 12px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.2);
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
    \`;

    panel.innerHTML = \`
      <div style="text-align: center; margin-bottom: 20px;">
        <h3 style="margin: 0 0 10px 0; font-size: 20px; font-weight: 600;">
          ğŸ·ï¸ æ ‡ç­¾æ˜¾ç¤ºæ§åˆ¶ä¸­å¿ƒ
        </h3>
        <div style="font-size: 14px; opacity: 0.9;">
          å·²éšè— \${fieldCodes.length} ä¸ªå­—æ®µæ ‡ç­¾ï¼Œç®€åŒ–ç•Œé¢æ˜¾ç¤º
        </div>
      </div>
      
      <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 12px; margin-bottom: 15px;">
        <button id="toggleAllLabels" style="padding: 12px; background: rgba(255,255,255,0.2); color: white; border: 2px solid rgba(255,255,255,0.3); border-radius: 8px; cursor: pointer; transition: all 0.3s ease; font-weight: 500;">
          ğŸ‘ï¸ åˆ‡æ¢æ‰€æœ‰æ ‡ç­¾
        </button>
        <button id="showLabelInfo" style="padding: 12px; background: rgba(255,255,255,0.2); color: white; border: 2px solid rgba(255,255,255,0.3); border-radius: 8px; cursor: pointer; transition: all 0.3s ease; font-weight: 500;">
          â„¹ï¸ æ˜¾ç¤ºæ ‡ç­¾çŠ¶æ€
        </button>
        <button id="optimizeLayout" style="padding: 12px; background: rgba(255,255,255,0.2); color: white; border: 2px solid rgba(255,255,255,0.3); border-radius: 8px; cursor: pointer; transition: all 0.3s ease; font-weight: 500;">
          ğŸ“± ä¼˜åŒ–ç§»åŠ¨å¸ƒå±€
        </button>
        <button id="restoreDefaults" style="padding: 12px; background: rgba(255,255,255,0.2); color: white; border: 2px solid rgba(255,255,255,0.3); border-radius: 8px; cursor: pointer; transition: all 0.3s ease; font-weight: 500;">
          ğŸ”„ æ¢å¤é»˜è®¤
        </button>
      </div>
      
      <div id="statusDisplay" style="background: rgba(0,0,0,0.2); padding: 10px; border-radius: 6px; font-size: 13px; font-family: monospace;">
        çŠ¶æ€ï¼šæ‰€æœ‰æ ‡ç­¾å·²éšè— | ç•Œé¢å·²ä¼˜åŒ–
      </div>
    \`;

    // æ·»åŠ æŒ‰é’®æ‚¬åœæ•ˆæœ
    const buttons = panel.querySelectorAll('button');
    buttons.forEach(button => {
      button.addEventListener('mouseenter', function() {
        this.style.background = 'rgba(255,255,255,0.3)';
        this.style.transform = 'translateY(-2px)';
      });
      
      button.addEventListener('mouseleave', function() {
        this.style.background = 'rgba(255,255,255,0.2)';
        this.style.transform = 'translateY(0)';
      });
    });

    // ç»‘å®šæ§åˆ¶äº‹ä»¶
    panel.addEventListener('click', (e) => handleControlPanelClick(e, fieldCodes));

    return panel;
  }

  // å¤„ç†æ§åˆ¶é¢æ¿ç‚¹å‡»äº‹ä»¶
  let labelsHidden = true;
  function handleControlPanelClick(event, fieldCodes) {
    const target = event.target;
    const statusDisplay = document.getElementById('statusDisplay');
    
    if (target.id === 'toggleAllLabels') {
      toggleAllLabelsVisibility(fieldCodes);
      labelsHidden = !labelsHidden;
      updateStatus(statusDisplay, labelsHidden ? 'æ‰€æœ‰æ ‡ç­¾å·²éšè—' : 'æ‰€æœ‰æ ‡ç­¾å·²æ˜¾ç¤º');
      
    } else if (target.id === 'showLabelInfo') {
      showLabelStatusInfo(fieldCodes);
      
    } else if (target.id === 'optimizeLayout') {
      optimizeFormLayout();
      updateStatus(statusDisplay, 'ç§»åŠ¨å¸ƒå±€å·²ä¼˜åŒ–');
      
    } else if (target.id === 'restoreDefaults') {
      restoreDefaultLabels(fieldCodes);
      labelsHidden = false;
      updateStatus(statusDisplay, 'å·²æ¢å¤é»˜è®¤æ ‡ç­¾æ˜¾ç¤º');
    }
  }

  // æ›´æ–°çŠ¶æ€æ˜¾ç¤º
  function updateStatus(statusElement, message) {
    if (statusElement) {
      const timestamp = new Date().toLocaleTimeString();
      statusElement.innerHTML = \`çŠ¶æ€ï¼š\${message} | æ›´æ–°æ—¶é—´ï¼š\${timestamp}\`;
    }
  }

  // åˆ‡æ¢æ‰€æœ‰æ ‡ç­¾å¯è§æ€§
  function toggleAllLabelsVisibility(fieldCodes) {
    fieldCodes.forEach(fieldCode => {
      if (labelsHidden) {
        kinlink.formApi.showFieldLabel(fieldCode);
      } else {
        kinlink.formApi.hideFieldLabel(fieldCode);
      }
    });
    
    kinlink.formApi.showMessage(
      'info', 
      labelsHidden ? 'æ‰€æœ‰æ ‡ç­¾å·²æ˜¾ç¤º' : 'æ‰€æœ‰æ ‡ç­¾å·²éšè—', 
      2
    );
  }

  // æ˜¾ç¤ºæ ‡ç­¾çŠ¶æ€ä¿¡æ¯
  function showLabelStatusInfo(fieldCodes) {
    let info = 'å­—æ®µæ ‡ç­¾çŠ¶æ€æŠ¥å‘Š:\\n\\n';
    
    fieldCodes.forEach(fieldCode => {
      const element = kinlink.formApi.getFieldElement(fieldCode);
      const isVisible = element ? getComputedStyle(element.querySelector('.ant-form-item-label') || element).display !== 'none' : false;
      info += \`å­—æ®µ: \${fieldCode}\\næ ‡ç­¾çŠ¶æ€: \${isVisible ? 'æ˜¾ç¤º' : 'éšè—'}\\n\\n\`;
    });
    
    info += \`æ€»è®¡: \${fieldCodes.length} ä¸ªå­—æ®µ\\n\`;
    info += \`å½“å‰æ—¶é—´: \${new Date().toLocaleString()}\`;
    
    alert(info);
  }

  // ä¼˜åŒ–è¡¨å•å¸ƒå±€
  function optimizeFormLayout() {
    const formItems = document.querySelectorAll('.ant-form-item');
    formItems.forEach(item => {
      // å‡å°‘å­—æ®µé—´è·
      item.style.marginBottom = '16px';
      
      // ä¼˜åŒ–è¾“å…¥æ¡†æ ·å¼
      const input = item.querySelector('input, textarea, select');
      if (input) {
        input.style.fontSize = '16px'; // é˜²æ­¢ç§»åŠ¨ç«¯ç¼©æ”¾
        input.style.padding = '12px';
        input.style.borderRadius = '8px';
        input.style.transition = 'all 0.3s ease';
      }
    });
    
    kinlink.formApi.showMessage('success', 'è¡¨å•å¸ƒå±€å·²ä¼˜åŒ–', 2);
  }

  // æ¢å¤é»˜è®¤æ ‡ç­¾
  function restoreDefaultLabels(fieldCodes) {
    fieldCodes.forEach(fieldCode => {
      kinlink.formApi.showFieldLabel(fieldCode);
    });
    
    // ç§»é™¤è‡ªå®šä¹‰æ ·å¼
    const formItems = document.querySelectorAll('.ant-form-item');
    formItems.forEach(item => {
      item.style.marginBottom = '';
      const input = item.querySelector('input, textarea, select');
      if (input) {
        input.style.fontSize = '';
        input.style.padding = '';
        input.style.borderRadius = '';
      }
    });
    
    kinlink.formApi.showMessage('info', 'å·²æ¢å¤æ‰€æœ‰é»˜è®¤è®¾ç½®', 2);
  }

  // ä¸ºéšè—æ ‡ç­¾çš„å­—æ®µæ·»åŠ å ä½ç¬¦
  function addPlaceholdersForHiddenLabels(fieldCodes) {
    const placeholderTexts = {
      'æ–‡å­—åˆ—__1è¡Œ__0': 'è¯·è¾“å…¥æ‚¨çš„å§“å',
      'æ–‡å­—åˆ—__1è¡Œ__1': 'è¯·è¾“å…¥å‡åè¯»éŸ³',
      'æ–‡å­—åˆ—__1è¡Œ__2': 'è¯·è¾“å…¥æ‰‹æœºå·ç ',
      'æ–‡å­—åˆ—__1è¡Œ__3': 'è¯·è¾“å…¥é‚®ç®±åœ°å€',
      'å•è¡Œæ–‡æœ¬æ¡†_10': 'è¯·è¾“å…¥å…¬å¸åç§°',
      'å•è¡Œæ–‡æœ¬æ¡†_11': 'è¯·è¾“å…¥èº«ä»½è¯å·ç '
    };
    
    fieldCodes.forEach(fieldCode => {
      const element = kinlink.formApi.getFieldElement(fieldCode);
      if (element) {
        const input = element.querySelector('input, textarea');
        if (input && placeholderTexts[fieldCode]) {
          input.placeholder = placeholderTexts[fieldCode];
          input.style.fontWeight = '500';
        }
      }
    });
  }

  // æ·»åŠ éšè—æ ‡ç­¾æ•ˆæœ
  function addHiddenLabelEffect(element) {
    if (element) {
      element.style.transition = 'all 0.3s ease';
      element.style.transform = 'translateX(-10px)';
      setTimeout(() => {
        element.style.transform = 'translateX(0)';
      }, 300);
    }
  }

  // ç§»åŠ¨ç«¯ä¼˜åŒ–è®¾ç½®
  function setupMobileOptimization() {
    // æ£€æµ‹ç§»åŠ¨è®¾å¤‡
    const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
    
    if (isMobile) {
      // ç§»åŠ¨ç«¯ç‰¹æ®Šä¼˜åŒ–
      const style = document.createElement('style');
      style.textContent = \`
        .ant-form-item {
          margin-bottom: 12px !important;
        }
        .ant-input, .ant-select-selector {
          font-size: 16px !important;
          padding: 10px 12px !important;
        }
        .label-control-panel {
          position: sticky !important;
          top: 0 !important;
          z-index: 1000 !important;
        }
      \`;
      document.head.appendChild(style);
      
      console.log('ç§»åŠ¨ç«¯ä¼˜åŒ–å·²å¯ç”¨');
    }
  }
})();`} 
              language="javascript" 
            />
        </TabsContent>
      </Tabs>
    </div>
    </div>

    <div>
      <h2>ä½¿ç”¨è¯´æ˜</h2>
      <div>
        è¦ä½¿ç”¨æ­¤åŠŸèƒ½ï¼Œåªéœ€å°†ä»£ç å¤åˆ¶åˆ°æ‚¨çš„kinlinkè‡ªå®šä¹‰JavaScriptä¸­ã€‚ä»£ç ä¼šè‡ªåŠ¨éšè—æŒ‡å®šå­—æ®µçš„æ ‡ç­¾ï¼Œå¹¶æä¾›ä¸€ä¸ªæ§åˆ¶é¢æ¿æ¥ç®¡ç†æ ‡ç­¾æ˜¾ç¤ºçŠ¶æ€ã€‚
    </div>
      <div>
        å®Œæ•´ä»£ç è¯·ä¸‹è½½æŸ¥çœ‹ï¼š
        <a
          href="/samplesCodes/12-éšè—kintoneæ ‡ç­¾.js"
          className="text-primary hover:underline ml-1"
          download="12-éšè—kintoneæ ‡ç­¾.js"
        >
          12-éšè—kintoneæ ‡ç­¾.js
        </a>
      </div>
      <div className="p-4 border rounded-md bg-yellow-50 dark:bg-yellow-900/20 border-yellow-200 dark:border-yellow-700">
        <h3 className="font-semibold text-yellow-800 dark:text-yellow-200">æ³¨æ„äº‹é¡¹</h3>
        <div className="text-yellow-800 dark:text-yellow-300">
          éšè—æ ‡ç­¾åï¼Œå»ºè®®ä¸ºå­—æ®µæ·»åŠ é€‚å½“çš„å ä½ç¬¦æ–‡æœ¬ï¼Œä»¥ç¡®ä¿ç”¨æˆ·ä»èƒ½ç†è§£å­—æ®µçš„ç”¨é€”ã€‚åœ¨ç§»åŠ¨è®¾å¤‡ä¸Šè¦ç‰¹åˆ«æ³¨æ„å¯ç”¨æ€§ã€‚
        </div>
      </div>
    </div>

    <div>
      <h2>APIå‚è€ƒ</h2>
      <div>æ­¤ç¤ºä¾‹ä½¿ç”¨äº†ä»¥ä¸‹kinlink APIï¼š</div>
      <ul>
        <li>
          <code>kinlink.events.on(eventName, callback)</code> -
          æ³¨å†Œäº‹ä»¶ç›‘å¬å™¨
        </li>
        <li>
          <code>kinlink.FormEvents.FORM_LOADED</code> - è¡¨å•åŠ è½½å®Œæˆäº‹ä»¶
        </li>
        <li>
          <code>kinlink.formApi.hideFieldLabel(fieldCode)</code> -
          éšè—æŒ‡å®šå­—æ®µçš„æ ‡ç­¾
        </li>
        <li>
          <code>kinlink.formApi.showFieldLabel(fieldCode)</code> -
          æ˜¾ç¤ºæŒ‡å®šå­—æ®µçš„æ ‡ç­¾
        </li>
        <li>
          <code>kinlink.formApi.getFieldElement(fieldCode)</code> -
          è·å–æŒ‡å®šå­—æ®µçš„DOMå…ƒç´ 
        </li>
        <li>
          <code>kinlink.formApi.showMessage(type, message, duration)</code> -
          æ˜¾ç¤ºæ¶ˆæ¯æç¤º
        </li>
      </ul>
    </div>
  </div>
</div> 