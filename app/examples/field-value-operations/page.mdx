import { Tabs, TabsContent, TabsList, TabsTrigger } from "@/components/ui/tabs";
import { CodeBlock } from "@/components/code-block";
import Link from "next/link";
import { ArrowLeft } from "lucide-react";
import { Button } from "@/components/ui/button";

<div className="container py-6 lg:py-10">
  <div className="flex items-center gap-4 mb-8">
    <Link href="/examples">
      <Button variant="outline" size="icon">
        <ArrowLeft className="h-4 w-4" />
      </Button>
    </Link>
    <h1 className="text-3xl font-bold tracking-tight">字段值操作实战示例</h1>
  </div>

  <div className="my-8 space-y-6">
    <div className="space-y-4">
      <h2 className="text-2xl font-bold tracking-tight">实例功能概览</h2>
      > 表单字段值的完整操作演示，涵盖读取、设置、批量处理的实际应用场景

      此示例演示如何使用**kinlink API**读取和设置表单字段的值。这是表单操作中最基础也是最重要的功能之一，包括**单个字段操作**和**批量字段操作**。

      ### 核心操作能力
      - 🔧 **字段值设置**：单个和批量字段值的精确控制
      - 📖 **字段值读取**：获取当前表单数据状态
      - 🎯 **交互式测试**：动态按钮演示操作效果
      - 📋 **数据预填充**：自动化表单初始化
      - 🔍 **实时反馈**：操作结果的即时显示
      - ⚡ **性能优化**：批量操作提升处理效率
    </div>

    <div className="space-y-4">
      <h2 className="text-2xl font-bold tracking-tight">实现代码演示</h2>
      > 完整的字段值操作实现，包含初始化、测试工具和错误处理

      <Tabs defaultValue="javascript">
        <TabsList>
          <TabsTrigger value="javascript">JavaScript</TabsTrigger>
        </TabsList>
        <TabsContent value="javascript">
          <CodeBlock 
            code={`/**
 * 示例5: 字段值读取与设置
 * 功能：获取和设置表单字段的值
 */
(function () {
  // 初始化表单
  kinlink.events.on(kinlink.FormEvents.FORM_LOADED, () => {
    try {
      // 设置单个字段值
      kinlink.formApi.setFieldValue('单行文本框_0', '测试案件');

      // 批量设置多个字段值
      kinlink.formApi.setFieldsValue({
        文字列__1行__0: '山田',
        文字列__1行__1: '太郎',
        单行文本框_8: 'YAMADA',
        单行文本框_9: 'TARO',
        单选框_0: '男',
        日期_1: '1990-01-01',
      });

      // 创建测试按钮，显示当前表单值
      const showValuesButton = document.createElement('button');
      showValuesButton.type = 'button';
      showValuesButton.textContent = '显示当前表单值';
      showValuesButton.style.margin = '10px 0';
      showValuesButton.style.padding = '5px 10px';

      showValuesButton.addEventListener('click', () => {
        // 获取单个字段值
        const name = kinlink.formApi.getFieldValue('文字列__1行__0');
        console.log('姓氏:', name);

        // 获取所有字段值
        const allValues = kinlink.formApi.getAllValues();
        console.log('所有字段值:', allValues);

        // 显示提示信息
        kinlink.formApi.showInfo(
          \`当前姓名: \${name} \${kinlink.formApi.getFieldValue('文字列__1行__1')}\`,
        );
      });

      // 添加按钮到表单
      const formElement = document.querySelector('.ant-form') || document.body;
      formElement.insertBefore(showValuesButton, formElement.firstChild);

      // 创建自动填充测试数据的按钮
      const fillDataButton = document.createElement('button');
      fillDataButton.type = 'button';
      fillDataButton.textContent = '填充测试数据';
      fillDataButton.style.margin = '10px 5px';
      fillDataButton.style.padding = '5px 10px';

      fillDataButton.addEventListener('click', () => {
        kinlink.formApi.setFieldsValue({
          文字列__1行__0: '李',
          文字列__1行__1: '小明',
          单行文本框_8: 'LI',
          单行文本框_9: 'XIAOMING',
          单行文本框_10: 'ABC株式会社',
          单行文本框_11: 'P12345678',
          单选框_0: '男',
          日期_1: '1995-05-15',
          日期_2: '2030-12-31',
          文字列__1行__2: '13800138000',
          文字列__1行__3: 'test@example.com',
          下拉菜单: 'A',
        });
        kinlink.formApi.showSuccess('测试数据已填充');
      });

      formElement.insertBefore(fillDataButton, formElement.firstChild);
    } catch (error) {
      console.error('字段值操作失败:', error);
    }
  });
})();`} 
            language="javascript" 
          />
        </TabsContent>
      </Tabs>
    </div>

    <div className="space-y-4">
      <h2 className="text-2xl font-bold tracking-tight">部署使用指南</h2>
      > 将示例代码集成到您的kinlink项目中的详细步骤

      **集成步骤：**
      1. 将上述代码复制到您的**kinlink自定义JavaScript**中
      2. 根据您的表单字段修改相应的**字段代码**
      3. 保存并刷新表单页面查看效果

      **字段代码映射：** 请确保将示例中的字段代码（如`'单行文本框_0'`、`'文字列__1行__0'`）替换为您实际表单中的字段代码。

      <div className="p-4 border rounded-md bg-green-50 border-green-200">
        <h3 className="font-semibold text-green-800">💡 功能演示</h3>
        <div className="text-green-800">
          代码会自动添加**"显示当前表单值"**和**"填充测试数据"**两个按钮，您可以通过这些按钮测试字段值的读取和设置功能。
        </div>
      </div>
    </div>

    <div className="space-y-4">
      <h2 className="text-2xl font-bold tracking-tight">API函数参考</h2>
      > 本示例使用的核心kinlink API方法说明

      **字段值操作API：**
      - **`kinlink.formApi.setFieldValue(fieldCode, value)`** - 设置单个字段的值
      - **`kinlink.formApi.setFieldsValue(values)`** - 批量设置多个字段的值
      - **`kinlink.formApi.getFieldValue(fieldCode)`** - 获取单个字段的值
      - **`kinlink.formApi.getAllValues()`** - 获取所有字段的值

      **消息提示API：**
      - **`kinlink.formApi.showInfo(message)`** - 显示信息消息
      - **`kinlink.formApi.showSuccess(message)`** - 显示成功消息

      **事件监听API：**
      - **`kinlink.events.on(kinlink.FormEvents.FORM_LOADED, callback)`** - 监听表单加载完成事件
    </div>

  </div>
</div> 